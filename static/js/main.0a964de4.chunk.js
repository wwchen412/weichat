(this.webpackJsonpweichat=this.webpackJsonpweichat||[]).push([[0],{27:function(e,t,a){e.exports=a(44)},32:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(25),l=a.n(c),o=(a(32),a(33),a(7)),s=a(20),u=a(2),i=a(3),m=a(14),p=a.n(m);a(34),a(36);p.a.initializeApp({apiKey:"AIzaSyBWgHetjjRDzGTDr8FvogbV8mG1gGeLwjY",authDomain:"weichat-2aac0.firebaseapp.com",databaseURL:"https://weichat-2aac0.firebaseio.com",projectId:"weichat-2aac0",storageBucket:"weichat-2aac0.appspot.com",messagingSenderId:"690893761233",appId:"1:690893761233:web:4d4a83412c1aa7589033f0",measurementId:"G-WG9ZP3LS4B"});var b=p.a.auth,f=p.a.database();var h=function(){return r.a.createElement("header",null,r.a.createElement("nav",{className:"navbar navbar-expand-sm fixed-top navbar-light bg-light"},r.a.createElement(i.b,{className:"navbar-brand",to:"/"},"WeiChat"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse justify-content-end",id:"navbarNavAltMarkup"},b().currentUser?r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(i.b,{className:"nav-item nav-link mr-3",to:"/chat"},"Profile"),r.a.createElement("button",{className:"btn btn-primary mr-3 mt-0",onClick:function(){return b().signOut()}},"Logout")):r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(i.b,{className:"nav-item nav-link mr-3",to:"/login"},"Sign In"),r.a.createElement(i.b,{className:"nav-item nav-link mr-3",to:"/signup"},"Sign Up")))))};var v=function(){return r.a.createElement("footer",{className:"pt-5"},r.a.createElement("div",{className:"container text-center"},r.a.createElement("p",null,"\xa9 WeiChat 2020.")))},E=function(){return r.a.createElement("div",{className:"home"},r.a.createElement(h,null),r.a.createElement("section",null,r.a.createElement("div",{className:"jumbotron jumbotron-fluid mb-0 main_bg homePage d-flex align-items-center"},r.a.createElement("div",{className:"container text-center py-5"},r.a.createElement("h1",{className:"display-4"}," WeiChat "),r.a.createElement("p",{className:"lead"},"\u4e00\u500b\u5c08\u9580\u7528\u4f86\u8ddf\u6211\u804a\u5929\u7684\u5730\u65b9\uff0c\u5feb\u52a0\u5165\u5427\uff01"),r.a.createElement("div",{className:"mt-4"},r.a.createElement(i.b,{className:"btn btn-primary px-5 mr-3",to:"/signup"},"\u8a3b\u518a"),r.a.createElement(i.b,{className:"btn px-5 btn-outline-primary",to:"/login"},"\u767b\u5165"))))),r.a.createElement(v,null))},d=a(4),g=a.n(d),j=a(5),N=a(11),w=function(){var e,t=Object(n.useRef)(null),a=Object(n.useState)({user:b().currentUser,chats:[],content:"",readError:null,writeError:null}),c=Object(o.a)(a,2),l=c[0],s=c[1];Object(n.useEffect)((function(){!function(){var e=Object(N.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s((function(e){return Object(j.a)(Object(j.a)({},e),{},{readError:null})}));try{f.ref("chats").on("value",(function(e){var t=[];e.forEach((function(e){t.push(e.val())})),s((function(e){return Object(j.a)(Object(j.a)({},e),{},{chats:t})}))}))}catch(t){s((function(e){return Object(j.a)(Object(j.a)({},e),{},{readError:t.message})}))}case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),Object(n.useEffect)((function(){e.focus()})),Object(n.useLayoutEffect)((function(){t.current.scrollTop=t.current.scrollHeight}));var u=function(){var e=Object(N.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==l.content.trim()){e.next=3;break}return e.abrupt("return");case 3:return s(Object(j.a)(Object(j.a)({},l),{},{writeError:null})),e.prev=4,e.next=7,f.ref("chats").push({content:l.content,timestamp:Date.now(),uid:l.user.uid,email:l.user.email});case 7:s((function(e){return Object(j.a)(Object(j.a)({},e),{},{content:""})})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),s(Object(j.a)(Object(j.a)({},l),{},{writeError:e.t0.message}));case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(h,null),r.a.createElement("section",{className:"chatArea p-3"},r.a.createElement("div",{className:"chats"},r.a.createElement("div",{className:"chats_content",ref:t},l.chats.map((function(e){return r.a.createElement("div",{key:e.timestamp,className:l.user.uid===e.uid?"current_user":""},r.a.createElement("span",{className:"chats_userName"},e.email?e.email:"\u964c\u751f\u4eba"),r.a.createElement("div",{className:"chats_bubble"},e.content,r.a.createElement("span",{className:"chats_time"},function(e){var t=new Date(e);return"".concat(t.getHours(),":").concat(t.getMinutes())}(e.timestamp))))}))),r.a.createElement("form",{className:"chats_input",onSubmit:function(e){return u(e)}},r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{ref:function(t){return e=t},onChange:function(e){return t=e,void s(Object(j.a)(Object(j.a)({},l),{},{content:t.target.value}));var t},value:l.content}),l.error?r.a.createElement("p",null,l.writeError):null,r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Send"))))),r.a.createElement("div",null,"Login in as: ",r.a.createElement("strong",null,l.user.email))),r.a.createElement(v,null))};function O(e,t){return b().createUserWithEmailAndPassword(e,t)}function y(e,t){return b().signInWithEmailAndPassword(e,t)}function x(){var e=new b.GoogleAuthProvider;return b().signInWithPopup(e)}var k=function(){var e=Object(n.useState)(null),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),s=Object(o.a)(l,2),u=s[0],m=s[1],p=Object(n.useState)(""),b=Object(o.a)(p,2),f=b[0],h=b[1],v=function(){var e=Object(N.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),c(""),e.prev=2,e.next=5,O(u,f);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),c(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(N.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,x();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),c(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{style:{height:"100vh"},className:"bg-primary d-flex align-items-center h-full justify-content-center"},r.a.createElement("form",{style:{maxWidth:"495px",background:"#fff"},className:"rounded p-3 w-100",onSubmit:function(e){return v(e)}},r.a.createElement("h1",{className:"text-center"},"\u767b\u5165",r.a.createElement(i.b,{to:"/"},"WeiChat")),r.a.createElement("p",{className:"text-center"},"\u5275\u5efa\u5e33\u865f\u767b\u5165\u804a\u5929"),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"signUpEmail"},"\u4fe1\u7bb1"),r.a.createElement("input",{id:"signUpEmail",className:"form-control",placeholder:"example@gmail.com",name:"email",type:"email",value:u,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"signUpPassword"},"\u5bc6\u78bc"),r.a.createElement("input",{id:"signUpPassword",className:"form-control",placeholder:"\u81f3\u5c11\u516b\u4f4d\u6578",name:"password",type:"password",value:f,onChange:function(e){return h(e.target.value)}})),r.a.createElement("div",null,a?r.a.createElement("p",null,a):null,r.a.createElement("button",{type:"submit",className:"btn-primary btn"},"\u8a3b\u518a"),r.a.createElement("button",{onClick:function(e){return E(e)},type:"button",className:"btn btn-google ml-1"},"Sign up with Google"),r.a.createElement("hr",null),r.a.createElement("p",null,"\u5df2\u7d93\u6709\u5e33\u865f\u4e86\u55ce\uff1f",r.a.createElement(i.b,{to:"/login"},"\u767b\u5165")))))},S=function(){var e=Object(n.useState)(null),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),s=Object(o.a)(l,2),u=s[0],m=s[1],p=Object(n.useState)(""),b=Object(o.a)(p,2),f=b[0],h=b[1],v=function(){var e=Object(N.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),c(""),e.prev=2,e.next=5,y(u,f);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),c(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(N.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,x();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),c(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{style:{height:"100vh"},className:"bg-primary d-flex align-items-center h-full justify-content-center"},r.a.createElement("form",{style:{maxWidth:"495px",background:"#fff"},className:"rounded p-3 w-100",autoComplete:"off",onSubmit:function(e){return v(e)}},r.a.createElement("h1",{className:"login_title text-center"},"\u767b\u5165",r.a.createElement(i.b,{to:"/"},"WeiChat")),r.a.createElement("p",{className:"text-center"},"\u8acb\u8f38\u5165\u5e33\u865f\u5bc6\u78bc\u4f86\u767b\u5165"),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"signUpEmail"},"\u4fe1\u7bb1"),r.a.createElement("input",{id:"signUpEmail",className:"form-control",placeholder:"example@gmail.com",name:"email",type:"email",value:u,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"signUpPassword"},"\u5bc6\u78bc"),r.a.createElement("input",{id:"signUpPassword",className:"form-control",placeholder:"\u81f3\u5c11\u516b\u4f4d\u6578",name:"password",type:"password",value:f,onChange:function(e){return h(e.target.value)}})),r.a.createElement("div",null,a?r.a.createElement("p",null,a):null,r.a.createElement("button",{type:"submit",className:"btn-primary btn"},"\u767b\u5165"),r.a.createElement("button",{type:"button",className:"btn btn-google ml-1",onClick:function(e){return E(e)}},"Google \u767b\u5165"),r.a.createElement("hr",null),r.a.createElement("p",null,"\u6c92\u6709\u5e33\u865f\u5bc6\u78bc\u55ce\uff1f",r.a.createElement(i.b,{to:"/signup"},"\u8a3b\u518a")))))};function C(e){var t=e.component,a=e.authenticated,n=Object(s.a)(e,["component","authenticated"]);return r.a.createElement(u.b,Object.assign({},n,{render:function(e){return!0===a?r.a.createElement(t,e):r.a.createElement(u.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}function W(e){var t=e.component,a=e.authenticated,n=Object(s.a)(e,["component","authenticated"]);return r.a.createElement(u.b,Object.assign({},n,{render:function(e){return!1===a?r.a.createElement(t,e):r.a.createElement(u.a,{to:"/chat"})}}))}var U=function(){var e=!1,t=!0,a=Object(n.useState)(e),c=Object(o.a)(a,2),l=c[0],s=c[1],m=Object(n.useState)(t),p=Object(o.a)(m,2),f=p[0],h=p[1];return Object(n.useEffect)((function(){b().onAuthStateChanged((function(e){e?(s(!0),h(!1)):(s(!1),h(!1))}))}),[]),!0===f?r.a.createElement("h2",null,"Loading..."):r.a.createElement(i.a,null,r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/",component:E}),r.a.createElement(C,{path:"/chat",authenticated:l,component:w}),r.a.createElement(W,{path:"/signup",authenticated:l,component:k}),r.a.createElement(W,{path:"/login",authenticated:l,component:S})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.0a964de4.chunk.js.map